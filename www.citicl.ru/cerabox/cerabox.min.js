!function(window){window.CeraBox=new Class({version:"1.3.8",Implements:[Options],boxWindow:null,collection:[],currentItem:0,options:{ajax:null,swf:null,group:!0,width:null,height:null,displayTitle:!0,fullSize:!1,displayOverlay:!0,clickToClose:!1,loaderAtItem:!1,animation:"fade",errorLoadingMessage:"The requested content cannot be loaded or might not be supported. Please try again later.",titleFormat:"Item {number} / {total} {title}",addContentProtectionLayer:!1,mobileView:Browser.Platform.ios||Browser.Platform.android||Browser.Platform.webos,fixedPosition:!1,clickToCloseOverlay:!0,constrainProportions:!1,devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,preventScrolling:!1,events:{onOpen:function(){},onChange:function(){},onClose:function(){},onAnimationEnd:function(){}}},initialize:function(e,t){this.boxWindow=CeraBoxWindow,e=$$(e),t&&"null"!=typeOf(t.group)&&t.group===!1&&e.length>1&&e.each(function(e){e.store("cerabox",new CeraBox(e,t))}),this.setOptions(t),e.each(function(e,t){this.collection[t]=e;var o=e.dataset?"string"==typeOf(e.dataset.type)&&""!=e.dataset.type.trim()?e.dataset.type.trim():null:e.get("data-type")&&""!=e.get("data-type").trim()?e.get("data-type").trim():null;if(null!==this.options.ajax&&null===o||"ajax"==o)e.addEvent("click",function(e){return this._itemClick(e)?(this.currentItem=t,this.showAjax(),!0):!1}.bind(this));else if(e.get("href").test(/^#/i)&&null===o||"inline"==o)e.addEvent("click",function(e){return this._itemClick(e)?(this.currentItem=t,this.showInline(),!0):!1}.bind(this));else if(e.get("href").test(/\.(jpg|jpeg|png|gif|bmp)(.*)?$/i)&&null===o||"image"==o)e.addEvent("click",function(e){return this._itemClick(e)?(this.currentItem=t,this.showImage(),!0):!1}.bind(this));else if(e.get("href").test(/\.(swf)(.*)?$/i)&&null===o||"swf"==o)e.addEvent("click",function(e){return this._itemClick(e)?(this.currentItem=t,this.showSwf(),!0):!1}.bind(this));else{if(null!==o&&"iframe"!=o)throw"Unknown type in dataset: "+o;e.addEvent("click",function(e){return this._itemClick(e)?(this.currentItem=t,this.showIframe(),!0):!1}.bind(this))}}.bind(this))},showAjax:function(){var ceraBox=this,currentItem=ceraBox.collection[ceraBox.currentItem],requestEr=new Request.HTML(Object.merge({url:currentItem.get("href"),method:"post",data:"",evalScripts:!1,onSuccess:function(responseTree,responseElements,responseHTML,responseJavaScript){if(!1!==ceraBox.boxWindow.getBusy()){var assets=[];Array.each(responseElements,function(e){"img"==e.get("tag")&&e.get("src")&&assets.append([e.get("src")])});var assetsLoaded=function(){var ajaxEle=ceraBox.boxWindow.preLoadElement(responseTree);!0!==ceraBox.options.constrainProportions||ceraBox.options.width&&ceraBox.options.height||!ceraBox.options.width&&!ceraBox.options.height?(ajaxEle.setStyle("width",ceraBox.options.width?ceraBox.options.width:ajaxEle.getScrollSize().x),ajaxEle.setStyle("height",ceraBox.options.height?ceraBox.options.height:ajaxEle.getScrollSize().y)):ceraBox.options.width?(ajaxEle.set("height",Math.round(ajaxEle.getScrollSize().y*(ceraBox.boxWindow.sizeStringToInt(ceraBox.options.width,"x")/ajaxEle.getScrollSize().x))),ajaxEle.set("width",ceraBox.options.width)):(ajaxEle.set("width",Math.round(ajaxEle.getScrollSize().x*(ceraBox.boxWindow.sizeStringToInt(ceraBox.options.height,"y")/ajaxEle.getScrollSize().y))),ajaxEle.set("height",ceraBox.options.height));var dimension=ceraBox.boxWindow.getSizeElement(ajaxEle);ajaxEle=ajaxEle.get("html"),ceraBox.boxWindow.onLoad(dimension.width,dimension.height).addEvent("complete",function(){this.removeEvents("complete"),!1!==ceraBox.boxWindow.getBusy()&&(!1!==ceraBox.options.displayTitle&&ceraBox.boxWindow.displayTitle(currentItem.get("title")?currentItem.get("title"):"",ceraBox.currentItem+1,ceraBox.collection.length),ceraBox.boxWindow.setContent(new Element("div",{html:ajaxEle})).openWindow(),function(){eval(responseJavaScript)}.call(ceraBox))})};assets.length?Asset.images(assets,{onComplete:assetsLoaded}):assetsLoaded()}},onerror:ceraBox._timedOut.bind(ceraBox),onTimeout:ceraBox._timedOut.bind(ceraBox),onFailure:ceraBox._timedOut.bind(ceraBox),onException:ceraBox._timedOut.bind(ceraBox)},"object"===typeOf(ceraBox.options.ajax)?ceraBox.options.ajax:{})).send()},showInline:function(){var e=this,t=e.collection[e.currentItem],o=t.get("href").test(/^#\$/i)&&"null"!=typeOf(window[t.get("href").replace(/^#\$/i,"")])?"element"!=typeOf(window[t.get("href").replace(/^#\$/i,"")])?new Element("div",{html:window[t.get("href").replace(/^#\$/i,"")]}):window[t.get("href").replace(/^#\$/i,"")]:document.id(document.body).getElement(t.get("href"))?document.id(document.body).getElement(t.get("href")).clone():null;if(null!==o){var n=[];Array.each(o.getElements("img"),function(e){e.get("src")&&n.append([e.get("src")])});var i=function(){var n=e.boxWindow.preLoadElement(o.clone());!0!==e.options.constrainProportions||e.options.width&&e.options.height||!e.options.width&&!e.options.height?(n.setStyle("width",e.options.width?e.options.width:n.getScrollSize().x),n.setStyle("height",e.options.height?e.options.height:n.getSize().y)):e.options.width?(n.set("height",Math.round(n.getSize().y*(e.boxWindow.sizeStringToInt(e.options.width,"x")/n.getScrollSize().x))),n.set("width",e.options.width)):(n.set("width",Math.round(n.getScrollSize().x*(e.boxWindow.sizeStringToInt(e.options.height,"y")/n.getSize().y))),n.set("height",e.options.height));var i=e.boxWindow.getSizeElement(n);e.boxWindow.onLoad(i.width,i.height).addEvent("complete",function(){this.removeEvents("complete"),!1!==e.boxWindow.getBusy()&&(!1!==e.options.displayTitle&&e.boxWindow.displayTitle(t.get("title")?t.get("title"):"",e.currentItem+1,e.collection.length),e.boxWindow.setContent(o).openWindow())})};n.length?Asset.images(n,{onComplete:i}):i()}else e._timedOut()},showImage:function(){var e=this,t=e.collection[e.currentItem],o=new Asset.image(t.get("href"),{"class":"ceraImage",onload:function(){if(!1!==e.boxWindow.getBusy()){!0!==e.options.constrainProportions||e.options.width&&e.options.height||!e.options.width&&!e.options.height?(this.set("width",e.options.width?e.options.width:this.get("width")),this.set("height",e.options.height?e.options.height:this.get("height"))):e.options.width?(this.set("height",Math.round(this.get("height").toInt()*(e.boxWindow.sizeStringToInt(e.options.width,"x")/this.get("width")))),this.set("width",e.options.width)):(this.set("width",Math.round(this.get("width").toInt()*(e.boxWindow.sizeStringToInt(e.options.height,"y")/this.get("height")))),this.set("height",e.options.height));var n=e.boxWindow.getSizeElement(this);e.options.devicePixelRatio>1&&(n={width:n.width/e.options.devicePixelRatio,height:n.height/e.options.devicePixelRatio}),e.boxWindow.onLoad(n.width,n.height).addEvent("complete",function(){this.removeEvents("complete"),!1!==e.boxWindow.getBusy()&&(!1!==e.options.displayTitle&&e.boxWindow.displayTitle(t.get("title")?t.get("title"):"",e.currentItem+1,e.collection.length),e.boxWindow.setContent(o).openWindow())})}},onerror:e._timedOut.bind(e)})},showSwf:function(){if(0==Browser.Plugins.Flash.version)return void this._timedOut();var e=this,t=e.collection[e.currentItem],o={width:e.options.width?e.options.width:500,height:e.options.height?e.options.height:400},n=new Swiff(t.get("href"),Object.merge({width:o.width,height:o.height,params:{wMode:"opaque",base:/(.*)\/.+(\.swf).*/.exec(t.get("href"))[1]}},"object"===typeOf(e.options.swf)?e.options.swf:{}));e.boxWindow.onLoad(o.width,o.height).addEvent("complete",function(){this.removeEvents("complete"),!1!==e.boxWindow.getBusy()&&(!1!==e.options.displayTitle&&e.boxWindow.displayTitle(t.get("title")?t.get("title"):"",e.currentItem+1,e.collection.length),e.boxWindow.setContent(n).openWindow())})},showIframe:function(){this.boxWindow.setTimeOuter(this._timedOut.delay(1e4,this));var e=this,t=e.collection[e.currentItem],o=new IFrame({src:t.get("href"),"class":"ceraIframe",styles:{width:1,height:1,border:"0px"},events:{load:function(){if(!1!==e.boxWindow.getBusy()||e.boxWindow.getWindowOpen()){if(!e.options.width&&!e.options.height)try{!Browser.ie||Browser.version>8?this.contentWindow.onbeforeunload=function(){e.boxWindow.loading(e),this.setStyles({width:"1px",height:"1px"})}.bind(this):this.setStyles({width:"1px",height:"1px"})}catch(t){}e.options.width&&this.setStyle("width",e.options.width),e.options.height&&this.setStyle("height",e.options.height);var o=e.boxWindow.getSizeElement(this);e.boxWindow.onLoad(o.width,o.height).addEvent("complete",function(){this.removeEvents("complete"),(!1!==e.boxWindow.getBusy()||e.boxWindow.getWindowOpen())&&e.boxWindow.openWindow()})}}}});o.set("border",0),o.set("frameborder",0),this.boxWindow.setContent(o)},_timedOut:function(){var e=this,t=new Element("span",{"class":"cerabox-error",html:e.options.errorLoadingMessage}),o=e.boxWindow.preLoadElement(t.clone());o.setStyle("width","270px"),o.setStyle("height",o.getSize().y+"px"),this.options.mobileView&&t.setStyles({position:"absolute",top:"50%","margin-top":-Math.round(o.getSize().y/2)+"px"});var n=e.boxWindow.getSizeElement(o,!0);e.boxWindow.onLoad(n.width,n.height).addEvent("complete",function(){this.removeEvents("complete"),!1!==e.boxWindow.getBusy()&&(e.boxWindow.hideTitle(),e.boxWindow.setContent(t).openWindow())})},_itemClick:function(e){return e&&e.preventDefault(),this.boxWindow.getBusy()?!1:(this.boxWindow.loading(this),!0)},_log:function(e,t){try{console.log(e)}catch(o){t&&alert(e)}}}),window.CeraBoxWindow=function(e){function t(){C.getElement(".cerabox-left").removeEvents("click").setStyle("display","none"),C.getElement(".cerabox-right").removeEvents("click").setStyle("display","none"),I.collection[I.currentItem-1]&&C.getElement(".cerabox-left").setStyle("display","block").addEvent("click",function(e){e.stopPropagation(),b||(this.setStyle("display","none").removeEvents("click"),I.collection[I.currentItem-1].fireEvent("click",e))}),I.collection[I.currentItem+1]&&C.getElement(".cerabox-right").setStyle("display","block").addEvent("click",function(e){e.stopPropagation(),b||(this.setStyle("display","none").removeEvents("click"),I.collection[I.currentItem+1].fireEvent("click",e))})}function o(t,o){if(t=t||W.x,o=o||W.y,I.options.displayTitle&&!C.getElement(".cerabox-content iframe.ceraIframe")||P.hideTitle(),I.options.mobileView){document.id(document.body).setStyle("overflow","hidden");var n,i,l,a,r=90==Math.abs(e.orientation),s=r?screen.height:screen.width;return C.getElement(".cerabox-content iframe.ceraIframe")?(n=z.x,i=z.y,l=o*n/t>i?i/o:n/t,a=1,C.getElements(".cerabox-close, .cerabox-left, .cerabox-right, .cerabox-title").setStyles({"-webkit-transform":"scale("+z.x/s+")",transform:"scale("+z.x/s+")"})):(C.getElement(".cerabox-content img.ceraImage")||(t=Math.round(z.x*(s/z.x)),o=Math.round(z.y*(s/z.x))),n=Math.round(z.x*(s/z.x)),i=Math.round(z.y*(s/z.x)),l=o*n/t>i?i/o:n/t,a=z.x/s,C.getElements(".cerabox-close, .cerabox-left, .cerabox-right, .cerabox-title").setStyles({"-webkit-transform":"scale(1)",transform:"scale(1)"})),C.setStyles({position:"absolute",display:"block",width:n+"px",height:i+"px",opacity:1,left:document.id(document.body).getScroll().x,right:0,top:document.id(document.body).getScroll().y,bottom:0,margin:0,"-webkit-transform":"scale("+a+")",transform:"scale("+a+")"}),C.getElement(".cerabox-content").setStyles({width:Math.round(t*l),height:Math.round(o*l),left:(n-Math.round(t*l))/2,top:(i-Math.round(o*l))/2}),C.getElement(".cerabox-content iframe.ceraIframe")&&C.getElement(".cerabox-content iframe.ceraIframe").setStyles({width:Math.round(t*l),height:Math.round(o*l)}),C.set("tween",{duration:0}).tween("opacity",1).get("tween")}C.getElement(".cerabox-content iframe.ceraIframe")&&C.getElement(".cerabox-content iframe.ceraIframe").setStyles({width:t,height:o});var c={display:"block",width:t,height:o,opacity:1,"-webkit-transform":"scale(1)",transform:"scale(1)"};if(C.setStyles({position:I.options.fixedPosition?"fixed":"absolute",top:Math.round(z.y/2)+"px",left:Math.round(z.x/2)+"px",right:"auto",bottom:"auto"}),z.x>t+60?c["margin-left"]=Math.round(-t/2+(I.options.fixedPosition?0:document.id(document.body).getScroll().x))+"px":c["margin-left"]=Math.round(z.x/2-t-40+(I.options.fixedPosition?0:document.id(document.body).getScroll().x))+"px",z.y>o+40?c["margin-top"]=Math.round(-o/2+(I.options.fixedPosition?0:document.id(document.body).getScroll().y))+"px":c["margin-top"]=Math.round(-z.y/2+20+(I.options.fixedPosition?0:document.id(document.body).getScroll().y))+"px",C.getElement(".cerabox-content").setStyles({width:"100%",height:"100%",left:0,top:0}),S)return C.set("morph",{duration:150}).morph(c).get("morph");switch(I.options.animation){case"ease":var d=I.collection[I.currentItem];return Object.append(c,{top:C.getStyle("top"),left:C.getStyle("left")}),C.setStyles({display:"block",left:d.getPosition().x-(I.options.fixedPosition?document.id(document.body).getScroll().x:0)+"px",top:d.getPosition().y-(I.options.fixedPosition?document.id(document.body).getScroll().y:0)+"px",width:d.getSize().x+"px",height:d.getSize().y+"px",margin:0,opacity:0}).set("morph",{duration:200}).morph(c).get("morph");case"fade":default:return Object.append(c,{opacity:0}),C.setStyles(c).set("tween",{duration:200}).tween("opacity",1).get("tween")}}function n(){var e={display:"block",opacity:I.options.mobileView?1:.5,top:0,left:0,height:"100%",width:"100%",position:"fixed"};I.options.mobileView&&Object.merge(e,{top:0,left:0,width:document.id(document.body).getScrollSize().x+"px",height:document.id(document.body).getScrollSize().y+"px",position:"absolute"}),document.id("cerabox-background").setStyles(e)}function i(){var t={position:"fixed",display:"block",top:"50%",left:"50%","margin-top":"-20px","margin-left":"-20px","-webkit-transform":"scale(1)",transform:"scale(1)"};if(!0!==I.options.loaderAtItem||S){if(I.options.mobileView){var o=90==Math.abs(e.orientation),n=o?screen.height:screen.width;Object.append(t,{position:"absolute",top:Math.round(z.y/2-document.id("cerabox-loading").getStyle("height").toInt()/2+document.id(document.body).getScroll().y)+"px",left:Math.round(z.x/2-document.id("cerabox-loading").getStyle("width").toInt()/2+document.id(document.body).getScroll().x)+"px","margin-top":0,"margin-left":0,"-webkit-transform":"scale("+z.x/n+")",transform:"scale("+z.x/n+")"})}}else{var i=I.collection[I.currentItem];Object.append(t,{position:"absolute",top:Math.round(i.getSize().y/2-document.id("cerabox-loading").getStyle("height").toInt()/2+i.getPosition().y)+"px",left:Math.round(i.getSize().x/2-document.id("cerabox-loading").getStyle("width").toInt()/2+i.getPosition().x)+"px","margin-top":0,"margin-left":0})}document.id("cerabox-loading").setStyles(t),l()}function l(e){e||(e=0),document.id("cerabox-loading").getElement("div").setStyle("top",-40*e+"px"),e=(e+1)%12,"none"!=document.id("cerabox-loading").getStyle("display")&&l.delay(60,this,e)}function a(e,t){return"string"==typeOf(e)&&e.test("%")?z[t]*(e.toInt()/100):e.toInt()}function r(){var e=document.id(document.body);e.getElement("#cerabox")||e.adopt([new Element("div",{id:"cerabox-loading"}).adopt(new Element("div")),new Element("div",{id:"cerabox-background",events:{click:function(e){e.stop(),I.options.clickToCloseOverlay&&P.close()}}}),C=new Element("div",{id:"cerabox"}).adopt([new Element("div",{"class":"cerabox-content"}),new Element("div",{"class":"cerabox-title"}).adopt(new Element("span")),new Element("a",{"class":"cerabox-close",events:{click:function(e){e.stop(),P.close()}}}),new Element("a",{"class":"cerabox-left"}).adopt(new Element("span")),new Element("a",{"class":"cerabox-right"}).adopt(new Element("span")),new Element("div",{"class":"cerabox-content-protection"}),new Element("div",{id:"cerabox-ajaxPreLoader",styles:{"float":"left",overflow:"hidden",display:"block"}})])])}function s(){clearInterval(k),C.getElements(".cerabox-title, .cerabox-close, .cerabox-left, .cerabox-right").set("tween",{duration:500}).tween("opacity",0)}function c(){C.getElements(".cerabox-title, .cerabox-close, .cerabox-left, .cerabox-right").setStyle("opacity",1),clearInterval(k),I.options.mobileView&&!I.options.clickToClose&&"createTouch"in document&&!C.getElement(".cerabox-content iframe.ceraIframe")&&(k=s.delay(5e3))}function d(e){B=M=e.client}function h(e){M=e.client,e.preventDefault()}function p(t){if(null!==B.x&&null!==M.x){var o=u(),n=90==Math.abs(e.orientation),i=n?screen.height:screen.width;50<=Math.round(o*(i/z.x))?x(t,m()):(o||"a"==t.target.get("tag")||t.target.getParent(".cerabox-close")||t.target.getParent(".cerabox-left")||t.target.getParent(".cerabox-right")||(C.fireEvent("click",t),t.stop(),1!=C.getElement(".cerabox-close").getStyle("opacity")?c():s()),g())}else g()}function g(){B={x:null,y:null},M={x:null,y:null}}function u(){return Math.round(Math.sqrt(Math.pow(M.x-B.x,2)+Math.pow(M.y-B.y,2)))}function m(){var e=B.x-M.x,t=M.y-B.y,o=Math.round(180*Math.atan2(t,e)/Math.PI);return 0>o&&(o=360-Math.abs(o)),o}function x(e,t){t>=315||45>=t?C.getElement(".cerabox-right").fireEvent("click",e):t>=135&&225>=t&&C.getElement(".cerabox-left").fireEvent("click",e),g()}function w(e){e?(document.addEvent("mousewheel",y),document.addEvent("keydown",y)):(document.removeEvent("mousewheel",y),document.removeEvent("keydown",y))}function y(e){e.preventDefault()}var b=!1,f=!1,v=null,E=null,S=!1,I=null,W={x:0,y:0},k=null,B={x:null,y:null},M={x:null,y:null},z={x:0,y:0},C=null,O=new Class({initialize:function(){e.addEvent("domready",function(){r(),this.updateWindow(),document.id("cerabox-loading").addEvent("click",function(e){e.stop(),this.close(!0)}.bind(this)),document.addEvent("keyup",function(e){"esc"==e.key&&this.close(),"input"!=e.target.get("tag")&&"select"!=e.target.get("tag")&&"textarea"!=e.target.get("tag")&&("left"==e.key&&C.getElement(".cerabox-left").fireEvent("click",e),"right"==e.key&&C.getElement(".cerabox-right").fireEvent("click",e))}.bind(this)),C.addEvent("touchstart",d),C.addEvent("touchmove",h),C.addEvent("touchend",p),C.addEvent("touchcancel",g),document.id("cerabox-loading").addEvent("touchmove",function(e){e.stop()})}.bind(this)),e.addEvent("resize",this.updateWindow.bind(this)),e.addEvent("scroll",this.updateWindow.bind(this,"scroll")),e.addEvent("orientationchange",this.updateWindow.bind(this))},updateWindow:function(e){this.setViewport(),!S||null===I||b||"scroll"==e&&!I.options.mobileView||(b=!0,(!1!==I.options.displayOverlay||I.options.mobileView)&&n(),o().addEvent("complete",function(){this.removeEvents("complete"),c(),b=!1}))},close:function(e){b&&!e||f||!I||(b=!e,!0===I.options.preventScrolling&&w(!1),clearInterval(E),clearInterval(v),clearInterval(k),document.id("cerabox-loading").setStyle("display","none"),I.options.mobileView?(document.id("cerabox-background").setStyles({display:"none",width:0,height:0,opacity:0}),C.setStyles({display:"none"}),C.getElement(".cerabox-content").empty().setStyle("opacity",0),C.getElement(".cerabox-left").removeEvents("click").setStyle("display","none"),C.getElement(".cerabox-right").removeEvents("click").setStyle("display","none"),this.hideTitle(),S&&I.options.events.onClose.call(I,I.collection[I.currentItem],I.collection),I=null,S=!1,b=!1):C.set("tween",{duration:50}).tween("opacity",0).get("tween").addEvent("complete",function(){this.removeEvents("complete"),document.id("cerabox-background").set("tween",{duration:50,link:"chain"}).tween("opacity",0).get("tween").addEvent("chainComplete",function(){this.removeEvents("chainComplete"),document.id("cerabox-background").setStyle("display","none"),C.setStyles({display:"none"}),C.getElement(".cerabox-content").empty().setStyle("opacity",0),C.getElement(".cerabox-left").removeEvents("click").setStyle("display","none"),C.getElement(".cerabox-right").removeEvents("click").setStyle("display","none"),P.hideTitle(),S&&I.options.events.onClose.call(I,I.collection[I.currentItem],I.collection),I=null,S=!1,b=!1})}))},setContent:function(e){return C.getElement(".cerabox-content").empty().adopt(e),this},loading:function(e){if(!instanceOf(e,CeraBox))throw"Instance should be an instance of CeraBox";return this.setViewport(),I=e,b=!0,C.getElement(".cerabox-content-protection").setStyle("display","none"),!0===I.options.addContentProtectionLayer&&C.getElement(".cerabox-content-protection").setStyle("display","block"),C.setStyle("cursor","auto").removeEvents("click"),!0===I.options.clickToClose&&C.setStyle("cursor","pointer").addEvent("click",function(e){e.stop(),this.close()}.bind(this)),!0===I.options.preventScrolling&&w(!0),clearInterval(E),clearInterval(v),document.id("cerabox-loading").setStyle("display","none"),v=i.delay(200),C.removeClass("mobile"),I.options.mobileView&&C.addClass("mobile"),this},preLoadElement:function(e){return C.setStyle("display","block"),C.getElement("#cerabox-ajaxPreLoader").empty().adopt(e)},onLoad:function(e,t){return f=!0,clearInterval(E),clearInterval(v),(!1!==I.options.displayOverlay||I.options.mobileView)&&n(),C.getElement("#cerabox-ajaxPreLoader").empty().setStyles({width:"auto",height:"auto"}),W={x:e,y:t},C.getElement(".cerabox-content").set("tween",{duration:I.options.mobileView?0:300}).tween("opacity",S&&C.getElement(".cerabox-content iframe.ceraIframe")?1:0).get("tween")},openWindow:function(e,n){document.id("cerabox-loading").setStyle("display","none"),e=W.x=e||W.x,n=W.y=n||W.y;var i=I.collection[I.currentItem];return c(),S?(o(e,n),void(I.options.mobileView?(C.getElement(".cerabox-content").setStyle("opacity",1),f=!1,b=!1,t(),I.options.events.onChange.call(I,i,I.collection)):C.getElement(".cerabox-content").set("tween",{duration:C.getElement(".cerabox-content iframe.ceraIframe")?0:200}).tween("opacity",1).get("tween").addEvent("complete",function(){this.removeEvents("complete"),f=!1,b=!1,t(),I.options.events.onChange.call(I,i,I.collection)}))):(I.options.mobileView||C.getElement(".cerabox-content").setStyle("opacity",1),I.options.events.onOpen.call(I,i,I.collection),o(e,n).addEvent("complete",function(){this.removeEvents("complete"),I.options.mobileView&&C.getElement(".cerabox-content").setStyle("opacity",1),f=!1,b=!1,t(),I.options.events.onAnimationEnd.call(I,i,I.collection)}),i.blur(),void(S=!0))},displayTitle:function(e,t,o){o>1&&(e=I.options.titleFormat.substitute({number:t,total:o,title:e}));var n=C.getElement(".cerabox-title span");return e?(n.setStyle("display","block").set("text",e),n.set("html",n.get("html").replace("\n","<br>"))):n.setStyle("display","none"),this},hideTitle:function(){return C.getElement(".cerabox-title span").setStyle("display","none"),this},setViewport:function(){return z={x:e.innerWidth?e.innerWidth:e.getSize().x,y:e.innerHeight?e.innerHeight:e.getSize().y},this},getViewport:function(){return z},getCurrentInstance:function(){return I},getBusy:function(){return b},getWindowOpen:function(){return S},setTimeOuter:function(e){return E=e,this},getSizeElement:function(e,t){var o=0,n=0;if("iframe"==e.get("tag")){C.setStyle("display","block");try{o=e.get("width")?a(e.get("width"),"x"):e.getStyle("width").toInt()>1?a(e.getStyle("width"),"x"):e.contentWindow.document.getScrollSize().x?e.contentWindow.document.getScrollSize().x:.75*z.x}catch(i){o=.75*z.x}try{n=e.get("height")?a(e.get("height"),"y"):e.getStyle("height").toInt()>1?a(e.getStyle("height"),"y"):e.contentWindow.document.getScrollSize().y?e.contentWindow.document.getScrollSize().y:.75*z.y}catch(i){n=.75*z.y}return t||!1!==I.options.fullSize?{width:o,height:n}:(z.y-100<n&&(o+=Browser.Platform.mac?15:17),{width:z.x-50<o?z.x-50:o,height:z.y-100<n?z.y-100:n})}if(o=e.get("width")?a(e.get("width"),"x"):e.getStyle("width")&&"auto"!=e.getStyle("width")?a(e.getStyle("width"),"x"):z.x-50,n=e.get("height")?a(e.get("height"),"y"):e.getStyle("height")&&"auto"!=e.getStyle("height")?a(e.getStyle("height"),"y"):z.y-100,t||!1!==I.options.fullSize)return{width:o,height:n};var l=Math.min(Math.min(z.x-50,o)/o,Math.min(z.y-100,n)/n);return{width:Math.round(l*o),height:Math.round(l*n)}},sizeStringToInt:function(e,t){return a(e,t)}}),P=new O;return P}(window),Element.implement({cerabox:function(e){return this.store("cerabox",new CeraBox(this,e))}}),Elements.implement({cerabox:function(e){if(e&&"null"!=typeOf(e.group)&&e.group!==!0)this.each(function(t){t.store("cerabox",new CeraBox(t,e))});else{var t=new CeraBox(this,e);this.each(function(e){e.store("cerabox",t)})}return this}})}(window);